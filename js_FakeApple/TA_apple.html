<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/05704b3d70.js" crossorigin="anonymous"></script>
    <title>Apple</title>
</head>

<style>
    /* 清除boostrap的focus樣式，超多種要改，背下來!!!!!!! */
    .btn:focus,
    .btn:active:focus,
    .btn.active:focus,
    .btn.focus,
    .btn:active.focus,
    .btn.active.focus,
    button:focus {
        outline: none !important;
        box-shadow: none !important;
    }

    .color-btn,
    .fit-btn {
        border: 1px solid lightgray;
        position: relative;
    }

    [selected="true"]::after {
        content: '';
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        border: 2px solid lightskyblue;
        border-radius: 0.25rem;
    }
</style>

<body>
    <section class="apple-nav d-flex justify-content-center align-items-center bg-dark">
        <ul class="nav-bar list-unstyled d-flex m-0"></ul>
        <!-- <li class="btn btn-dark product" href="#iphone12">{{iphone12}}</li>
        <li class="btn btn-dark product" href="#iphone13">{{iphone13}}</li>
        <li class="btn btn-dark product" href="#iphoneSE">{{iphoneSE}}</li> -->
    </section>
    <section class="apple-info container d-flex justify-content-between align-items-center py-2">
        <h3 class="m-0 product-type">{{iphone12}}</h3>
        <strong class="m-0 price-top">{{$9,999}}</strong>
    </section>
    <section class="container py-3">
        <div class="row">
            <div class="col-12 col-md-6">
                <div class="img-box px-4 py-5">
                    <img class="product-img w-100" src="https://fakeimg.pl/600x400/400">
                </div>
            </div>
            <div class="col-12 col-md-6">
                <h1 class="product-name">{{iphone12}}</h1>
                <div class="accordion" id="accordionPanelsStayOpenExample">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="panelsStayOpen-headingOne">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#panelsStayOpen-color" aria-expanded="true"
                                aria-controls="panelsStayOpen-color">
                                {{外觀}}
                            </button>
                        </h2>
                        <!-- 這裡有改名，改成color -->
                        <div id="panelsStayOpen-color" class="accordion-collapse collapse show"
                            aria-labelledby="panelsStayOpen-headingOne">
                            <div class="accordion-body">
                                <h5><strong>外觀</strong></h5>
                                <div class="row color-area">
                                    <!-- <div class="col-6 mb-3">
                                        <button class="btn color-btn w-100">
                                            <div
                                                class="py-4 d-flex flex-column justify-content-center align-items-center">
                                                <i class="fas fa-circle"></i>
                                                <span class="color-name">{{黑色}}</span>
                                            </div>
                                        </button>
                                    </div> -->
                                    <!-- <div class="col-6 mb-3">
                                        <button class="btn color-btn w-100">
                                            <div
                                                class="py-4 d-flex flex-column justify-content-center align-items-center">
                                                <i class="fas fa-circle"></i>
                                                <span class="color-name">{{紅色}}</span>
                                            </div>
                                        </button>
                                    </div> -->
                                    <!-- <div class="col-6 mb-3">
                                        <button class="btn color-btn w-100">
                                            <div
                                                class="py-4 d-flex flex-column justify-content-center align-items-center">
                                                <i class="fas fa-circle"></i>
                                                <span class="color-name">{{黃色}}</span>
                                            </div>
                                        </button>
                                    </div> -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- <div class="accordion-item">
                        <h2 class="accordion-header" id="panelsStayOpen-headingOne">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#panelsStayOpen-spec" aria-expanded="true"
                                aria-controls="panelsStayOpen-spec">
                                {{儲存裝置}}
                            </button>
                        </h2>
                        <div id="panelsStayOpen-spec" class="accordion-collapse collapse show"
                            aria-labelledby="panelsStayOpen-headingOne">
                            <div class="accordion-body">
                                <h5><strong>儲存裝置</strong></h5>
                                <div class="row color-area">
                                    <div class="col-6 mb-3">
                                        <button class="btn w-100">
                                            <div
                                                class="py-4 d-flex flex-column justify-content-center align-items-center">
                                                <p class="color-name">{{128}}</p>
                                                <span>{{fit0}}</span>
                                            </div>
                                        </button>
                                    </div>
                                    <div class="col-6 mb-3">
                                        <button class="btn w-100">
                                            <div
                                                class="py-4 d-flex flex-column justify-content-center align-items-center">
                                                <p class="color-name">{{256}}</p>
                                                <span>{{fit3500}}</span>
                                            </div>
                                        </button>
                                    </div>
                                    <div class="col-6 mb-3">
                                        <button class="btn w-100">
                                            <div
                                                class="py-4 d-flex flex-column justify-content-center align-items-center">
                                                <p class="color-name">{{512}}</p>
                                                <span>{{fit10500}}</span>
                                            </div>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> -->
                    <!-- <div class="accordion-item">
                        <h2 class="accordion-header" id="panelsStayOpen-headingOne">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#panelsStayOpen-wifi" aria-expanded="true"
                                aria-controls="panelsStayOpen-wifi">
                                {{連線能力}}
                            </button>
                        </h2>
                        <div id="panelsStayOpen-wifi" class="accordion-collapse collapse show"
                            aria-labelledby="panelsStayOpen-headingOne">
                            <div class="accordion-body">
                                <h5><strong>連線能力</strong></h5>
                                <div class="row color-area">
                                    <div class="col-6 mb-3">
                                        <button class="btn w-100">
                                            <div
                                                class="py-4 d-flex flex-column justify-content-center align-items-center">
                                                <p>wifi</p>
                                                <span>{{fit0}}</span>
                                            </div>
                                        </button>
                                    </div>
                                    <div class="col-6 mb-3">
                                        <button class="btn w-100">
                                            <div
                                                class="py-4 d-flex flex-column justify-content-center align-items-center">
                                                <p>wifi+行動網路</p>
                                                <span>{{fit3000}}</span>
                                            </div>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                </div>
            </div>
        </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
        </script>
    <script>
        // 宣告
        const productList = [
            {
                name: 'iphone13',
                price: 22900,
                mainImg: 'https://picsum.photos/300/200/?random=10',

                colorList: [
                    { name: '紅色', color: '#ff0000', img: 'https://picsum.photos/300/200/?random=11' },
                    { name: '綠色', color: '#00ff00', img: 'https://picsum.photos/300/200/?random=12' },
                    { name: '藍色', color: '#0000ff', img: 'https://picsum.photos/300/200/?random=13' },
                ],
                spec: [
                    {
                        name: '容量',
                        specDetail: [
                            {
                                name: '128GB',
                                fit: 0
                            },
                            {
                                name: '256GB',
                                fit: 3500
                            },
                            {
                                name: '512GB',
                                fit: 10500
                            }
                        ]
                    },
                    {
                        name: '連線能力',
                        specDetail: [
                            {
                                name: 'Wi-Fi',
                                fit: 0
                            },
                            {
                                name: 'Wi-Fi + 行動網路',
                                fit: 5000
                            }
                        ]
                    }
                ],
            }
        ]


        // Dom
        const navbar = document.querySelector('.nav-bar')
        const productType = document.querySelector('.product-type')
        const priceTop = document.querySelector('.price-top')
        const productName = document.querySelector('.product-name')
        const productImg = document.querySelector('.product-img')


        //屬性選擇器抓accordion
        const colorAreaBtn = document.querySelector('[aria-controls="panelsStayOpen-color"]')
        const colorArea = document.querySelector('.color-area')
        const accordionBox = document.querySelector('.accordion')


        //window onload
        window.onload = function () {
            showNavBar()
            selectProduct(productList[0])
        }


        //function
        function showNavBar() {
            const list = productList.map(p => p.name)
            list.forEach((p, index) => {
                const li = document.createElement('li')
                const a = document.createElement('a')
                a.innerText = p
                a.href = `#${p}`
                a.classList.add('btn', 'btn-dark', 'product')

                a.onclick = function () {
                    selectProduct(productList[index])
                }

                li.appendChild(a)
                navbar.appendChild(li)
            })
        }

        function selectProduct(product) {
            productType.innerText = product.name
            productName.innerText = product.name
            productImg.src = product.mainImg
            priceTop.innerText = `$${product.price}`

            //color 部分
            product.colorList.forEach(item => {
                const div = document.createElement('div')
                div.classList.add('col-6', 'mb-3')
                const btn = document.createElement('button')
                btn.classList.add('btn', 'color-btn', 'w-100')

                btn.onclick = function () {
                    productImg.src = item.img
                    colorAreaBtn.innerText = item.name
                    colorAreaBtn.click()
                }

                const btnDiv = document.createElement('div')
                btnDiv.classList.add('py-4', 'd-flex', 'flex-column', 'justify-content-center', 'align-items-center')
                const i = document.createElement('i')
                i.classList.add('fas', 'fa-circle')
                i.style.color = item.color
                const span = document.createElement('span')
                span.classList.add('color-name')
                span.innerText = item.name

                btnDiv.appendChild(i)
                btnDiv.appendChild(span)
                btn.appendChild(btnDiv)
                div.appendChild(btn)
                colorArea.appendChild(div)
            })

            product.spec.forEach(item => {
                const accordionItem = document.createElement('div')
                accordionItem.classList.add('accordion-item')
                const accordionTitle = document.createElement('h2')
                accordionTitle.classList.add('accordion-header')
                const accordionBtn = document.createElement('button')
                accordionBtn.innerText = item.name
                accordionBtn.classList.add('accordion-button')
                accordionBtn.setAttribute('type', 'button')
                accordionBtn.setAttribute('data-bs-toggle', 'collapse')
                accordionBtn.setAttribute('data-bs-target', `#panelsStayOpen-${item.name}`)
                accordionBtn.setAttribute('aria-expanded', 'true')
                accordionBtn.setAttribute('aria-controls', `panelsStayOpen-${item.name}`)
                accordionTitle.appendChild(accordionBtn)

                const accordionContent = document.createElement('div')
                accordionContent.setAttribute('id', `panelsStayOpen-${item.name}`)
                accordionContent.classList.add('accordion-collapse', 'collapse', 'show')
                const accordionBody = document.createElement('div')
                accordionBody.classList.add('accordion-body')
                const h5 = document.createElement('h5')
                const strong = document.createElement('strong')
                h5.appendChild(strong)
                const specDiv = document.createElement('div')
                specDiv.classList.add('row')

                item.specDetail.forEach(specItem => {
                    const div = document.createElement('div')
                    div.classList.add('col-6', 'mb-3')
                    const btn = document.createElement('button')
                    btn.classList.add('btn', 'w-100', 'fit-btn')
                    btn.setAttribute('fit', specItem.fit)

                    btn.setAttribute('selected', 'false')
                    //顯示選取
                    btn.onclick = function () {

                        specDiv.querySelectorAll('.btn').forEach(b => {
                            b.setAttribute('selected', 'false')
                        })

                        btn.setAttribute('selected', 'true')
                        showPrice(product)
                        accordionBtn.innerText = specItem.name
                        accordionBtn.click()
                    }

                    const btnDiv = document.createElement('div')
                    btnDiv.classList.add('py-4', 'd-flex', 'flex-column', 'justify-content-center', 'align-items-center')

                    const p = document.createElement('p')
                    p.classList.add('spec-val', 'm-0')
                    p.innerText = specItem.name
                    const span = document.createElement('span')
                    span.classList.add('fit')
                    span.innerText = `NT$${product.price + specItem.fit}`
                    btnDiv.appendChild(p)
                    btnDiv.appendChild(span)
                    btn.appendChild(btnDiv)
                    div.appendChild(btn)
                    specDiv.appendChild(div)
                })

                accordionBody.appendChild(h5)
                accordionBody.appendChild(specDiv)
                accordionContent.appendChild(accordionBody)
                accordionItem.appendChild(accordionTitle)
                accordionItem.appendChild(accordionContent)
                accordionBox.appendChild(accordionItem)
            })
        }

        function showPrice(product) {
            const selectedFits = Array.from(document.querySelectorAll('[fit][selected="true"]'))
            const money = selectedFits.length > 0 ? selectedFits.map(x => parseInt(x.getAttributeNode('fit').value)).reduce((a, b) => a + b) : 0
            priceTop.innerText = `$${product.price + money}`
        }


    </script>
</body>

</html>